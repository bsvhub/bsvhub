<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<title>₿SVhub.io</title>
    <!-- MAIN STYLES -->
    <!-- ============================================================
     BASE DESKTOP STYLES (ALWAYS LOADED)
	============================================================ -->
	<link rel="stylesheet" href="styles/main.css">

	<!-- ============================================================
		 MOBILE OVERRIDES (DYNAMICALLY ENABLED)
		 - Empty by default
		 - JS will set href to styles/mobile.css when needed
	============================================================ -->
	<link id="mobile-css" rel="stylesheet" href="">

	<!-- ============================================================
		 BACKGROUND / EFFECT STYLES
	============================================================ -->
	<link rel="stylesheet" href="styles/firefly.css">

</head>

<body>
<div id="page-wrapper">
<!-- ============================================================
     LAYER 0 — BACKGROUND LAYERS
============================================================ -->

<div id="background-layer" class="background-layer"></div>
<div id="firefly-layer" class="firefly-layer"></div>

<audio id="copy-sfx" src="styles/assets/copy.mp3"></audio>


<!-- ============================================================
     LAYER 1 — TOP UI (HEADER + TAB BAR + TOOLTIP)
============================================================ -->

<div id="top-ui">

    <!-- HEADER -->
    <header class="header-container">
        <div class="header-icons header-icons-left">
            <a href="#" data-target="about-section" class="header-text-link">About</a>
            <a href="#" data-target="tip-section" class="header-text-link">Tip</a>
        </div>

        <h1 class="header-title">₿SVhub.io</h1>

        <div class="header-icons header-icons-right">
			<a href="#" data-target="contact-section" class="header-text-link">Contact</a>
            <a href="#" id="mobile-toggle" class="header-text-link">mobile</a>
            
        </div>
    </header>


    <!-- TAB BAR -->
    <nav class="tab-bar">

        <button class="tab-btn" data-target="tools">Tools</button>
        <button class="tab-btn" data-target="apps">Apps</button>
        <button class="tab-btn" data-target="wallets">Wallets</button>
        <button class="tab-btn" data-target="exchange">Buy BSV</button>
        <button class="tab-btn" data-target="bsv">BSV Main Sites</button>
        <button class="tab-btn" data-target="docs">Documents</button>
        <button class="tab-btn" data-target="social">Social</button>
        <button class="tab-btn" data-target="videos">Videos</button>

        <div class="search-container">
            <input id="search-box" type="text" placeholder="search here">
        </div>

    </nav>

    <!-- TOOLTIP BAR -->
    <div id="tooltip-display"></div>

</div>



<!-- ============================================================
     LAYER 2 — CONTENT AREA (SCROLLABLE)
============================================================ -->

<main id="content-area">

    <!-- SEARCH RESULTS -->
    <section id="search-results" class="tab-content"></section>

    <!-- STATIC ABOUT SECTION -->
    <section id="about-section" class="tab-content header-tab-content">
		<div class="header-tab-text">
			Number of visitors: 
			<span id="visit-counter" style="pointer-events:none;">
				<script src="https://counter.websiteout.com/js/7/6/0/0"></script>
			</span>
		</div>

		<div>Last update: <span id="last-update-date"></span></div>
	</section>



</main>
 
<script>
function loadLastUpdate() {
  fetch("list.json")
    .then(r => r.json())
    .then(data => {
      const date = data.sections?.["info-section"]?.lastUpdate;
      const el = document.getElementById("last-update-date");
      if (date && el) el.textContent = date;
    })
    .catch(err => console.error("Failed to load update date:", err));
}

loadLastUpdate();
</script>


    
<!-- ============================================================
     JS SECTION 1 — TOOLTIPS + MOBILE DOUBLE-TAP (EVENT DELEGATION)
     ------------------------------------------------------------
     Desktop: Hover tooltips, single-click links
     Mobile: First tap = tooltip, second tap = navigate
     Uses event delegation - works on all icons automatically
============================================================ -->
<script>
/* ============================================================
   TOOLTIP STATE
============================================================ */
const tooltipBox = document.getElementById("tooltip-display");
let defaultTooltipMessage = "Loading...";
let revertTimeout = null;
let lastTappedLink = null;

/* ============================================================
   MOBILE MODE DETECTION
============================================================ */
function isMobileMode() {
    const css = document.getElementById("mobile-css");
    return !!(css && css.href && css.href.includes("mobile.css"));
}

/* ============================================================
   DEFAULT TOOLTIP (MARQUEE)
============================================================ */
fetch("tooltip-message.txt")
    .then(r => r.text())
    .then(t => {
        defaultTooltipMessage = t.trim();
        showDefaultTooltip();
    })
    .catch(showDefaultTooltip);

function showDefaultTooltip() {
    const repeated = Array(40).fill(defaultTooltipMessage)
        .join("\u00A0\u00A0\u00A0•\u00A0\u00A0\u00A0");
    tooltipBox.innerHTML = `<span>${repeated}</span>`;
    tooltipBox.classList.add("marquee");
    tooltipBox.classList.remove("expanded");
}

/* ============================================================
   SET TOOLTIP TEXT
============================================================ */
function setTooltipText(text) {
    if (revertTimeout) clearTimeout(revertTimeout);

    if (text) {
        tooltipBox.innerHTML = text;
        tooltipBox.classList.remove("marquee");
        tooltipBox.classList.add("expanded");
    } else {
        revertTimeout = setTimeout(showDefaultTooltip, 2000);
    }

    // Re-measure layout after tooltip change
    requestAnimationFrame(() => {
        if (typeof positionContent === "function") positionContent();
    });
}

/* ============================================================
   DESKTOP HOVER TOOLTIPS (EVENT DELEGATION)
============================================================ */
document.addEventListener("mouseenter", (e) => {
    if (isMobileMode()) return;
    const wrap = e.target.closest(".icon-wrapper[data-tooltip]");
    if (wrap) setTooltipText(wrap.dataset.tooltip);
}, true);

document.addEventListener("mouseleave", (e) => {
    if (isMobileMode()) return;
    const wrap = e.target.closest(".icon-wrapper[data-tooltip]");
    if (wrap) setTooltipText("");
}, true);

/* ============================================================
   MOBILE DOUBLE-TAP (EVENT DELEGATION)
   - Works on all icons including search results
   - No binding or mutation observer needed
============================================================ */
document.addEventListener("click", (e) => {
    if (!isMobileMode()) return;
    
    const wrap = e.target.closest(".icon-wrapper");
    if (!wrap) return;
    
    const link = wrap.closest("a");
    if (!link) return;

    // Clear previous selection if different icon
    if (lastTappedLink && lastTappedLink !== link) {
        lastTappedLink.classList.remove("mobile-selected");
    }

    // First tap - show tooltip
    if (!link.classList.contains("mobile-selected")) {
        e.preventDefault();
        link.classList.add("mobile-selected");
        lastTappedLink = link;
        setTooltipText(wrap.dataset.tooltip || wrap.textContent || "Tap again to open");
        return;
    }

    // Second tap - navigate (allow default)
    link.classList.remove("mobile-selected");
    lastTappedLink = null;
}, true);

/* ============================================================
   CLEAR SELECTION HELPER
============================================================ */
function clearDoubleTapSelection() {
    if (lastTappedLink) {
        lastTappedLink.classList.remove("mobile-selected");
        lastTappedLink = null;
        setTooltipText("");
    }
}

/* ============================================================
   AUTO-CLEAR TRIGGERS
============================================================ */
// Clear on outside click
document.addEventListener('pointerdown', (e) => {
    if (!isMobileMode()) return;
    const isIconArea = e.target.closest('.icon-wrapper');
    if (!isIconArea) clearDoubleTapSelection();
}, { capture: true });

// Clear on ESC key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') clearDoubleTapSelection();
});

// Clear on window blur
window.addEventListener('blur', clearDoubleTapSelection);

// Clear on tab switch
document.addEventListener('visibilitychange', () => {
    if (document.hidden) clearDoubleTapSelection();
});

/* ============================================================
   TOOLTIP HEIGHT TRANSITION HANDLER
   - Re-measure layout when tooltip expands/collapses
============================================================ */
tooltipBox.addEventListener("transitionend", (e) => {
    if (e.propertyName === "max-height" || e.propertyName === "padding") {
        if (typeof positionContent === "function") positionContent();
    }
});
</script>  
    
<!-- ============================================================
     JS SECTION 2 — BACKGROUND GRADIENT
============================================================ -->

<script>
const colors = ["#555555", "#6a0dad", "#001f54"];
function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
document.getElementById("background-layer").style.background =
  `linear-gradient(135deg, ${shuffle([...colors]).join(', ')})`;
</script>


<!--=========================================================
     JS SECTION 3 — TAB SYSTEM  (WITH SEARCH RESET ADDED)
============================================================ -->
<script>
const tabButtons = document.querySelectorAll('.tab-btn');
const headerLinks = document.querySelectorAll('.header-text-link:not(#mobile-toggle)');


/* ------------------------------------------------------------
   RESET SEARCH
   - clears input
   - hides search results section
   - resets layout
------------------------------------------------------------ */
function resetSearch() {
    const resultSec = document.getElementById("search-results");
    const searchBox = document.getElementById("search-box");

    searchBox.value = "";                 // clear input
    resultSec.innerHTML = "";             // clear search results
    resultSec.classList.remove("active"); // hide search results

    // DEACTIVATE ALL TAB CONTENTS
    document.querySelectorAll('.tab-content').forEach(sec =>
        sec.classList.remove('active')
    );

    requestAnimationFrame(() => {
        if (typeof positionContent === "function") {
            positionContent(null);        // fix layout
        }
    });
}


/* ------------------------------------------------------------
   ACTIVATE TAB
------------------------------------------------------------ */
function activateTab(targetId, source) {
    tabButtons.forEach(b => b.classList.remove('active'));
    headerLinks.forEach(h => h.classList.remove('active'));

    if (source) source.classList.add('active');

    document.querySelectorAll('.tab-content').forEach(sec =>
        sec.classList.remove('active')
    );

    const sec = document.getElementById(targetId);
    if (sec) sec.classList.add('active');
}

/* ------------------------------------------------------------
   TAB BUTTON CLICK — WITH SEARCH RESET
------------------------------------------------------------ */
tabButtons.forEach(btn =>
    btn.addEventListener("click", () => {
        clearDoubleTapSelection(); // <-- NEW: release any armed icon
        resetSearch();  // <-- NEW
        activateTab(btn.dataset.target, btn);
    })
);

/* ------------------------------------------------------------
   HEADER LINK CLICK — WITH SEARCH RESET
------------------------------------------------------------ */
headerLinks.forEach(link =>
    link.addEventListener("click", (e) => {
        e.preventDefault();
        clearDoubleTapSelection(); // <-- NEW: release any armed icon
        resetSearch();  // <-- NEW
        activateTab(link.dataset.target, link);
    })
);

</script>



<script>
/* ============================================================
   4 — BASELINE CONTENT POSITIONING (NO HOVER SHIFTING)
   Keeps content-area placed directly below #top-ui.
   ============================================================ */


// index.html — reuse your existing positionContent function to also set a CSS var
(function () {
  const content = document.getElementById("content-area");
  const topUI = document.getElementById("top-ui");
  function positionContent() {
    const baseTop = topUI.offsetHeight;
    content.style.top = `${baseTop}px`;
    document.documentElement.style.setProperty('--top-ui-height', `${baseTop}px`);
  }
  window.positionContent = positionContent;
  window.addEventListener("resize", positionContent);
  requestAnimationFrame(positionContent);
})();

</script>


<!-- ============================================================
     JS SECTION 5 — JSON LOADER (FIXED & ROBUST)
     - builds sections
     - binds behaviors
     - positions content (double RAF)
     - auto-activates "new" tab or first tab fallback
============================================================ -->
<script>
fetch("list.json")
  .then(r => r.json())
  .then(data => {
    const container = document.getElementById("content-area");

    // Build sections
    Object.entries(data.sections).forEach(([id, section]) => {
      const sec = document.createElement("section");
      sec.id = id;
      sec.className = "tab-content";

      if (section.items) {
        const ul = document.createElement("ul");
        ul.className = "icon-grid";

        
		section.items.forEach(item => {
		  const li = document.createElement("li");

		  const a = document.createElement("a");
		  a.href = item.href || "#";
		  a.target = "_blank";

		  const wrap = document.createElement("div");
		  wrap.className = "icon-wrapper";
		  if (item.tooltip) wrap.dataset.tooltip = item.tooltip;

		  // Base icon image
		  const img = document.createElement("img");
		  img.src = item.img || "";
		  img.alt = item.alt || "";

		  // ----- NEW: conditional "new" badge -----
		  if (item.age === "new") {
			const badge = document.createElement("img");
			badge.src = "icon/new.png";   // your badge file
			badge.alt = "New";
			badge.className = "icon-badge-new";
			wrap.appendChild(badge);
		  }
		  // ---------------------------------------

		  // Existing label under the icon
		  const txt = document.createElement("div");
		  txt.className = "icon-text";
		  txt.textContent = item.text || "";

		  // Assemble
		  wrap.appendChild(img);
		  wrap.appendChild(txt);
		  a.appendChild(wrap);
		  li.appendChild(a);
		  ul.appendChild(li);
		});


        sec.appendChild(ul);
      }

      if (section.html) sec.innerHTML = section.html;

      container.appendChild(sec);
    });

    // Activate "new" tab AFTER sections exist and layout is stable
	requestAnimationFrame(() => {
		requestAnimationFrame(() => {
			const newBtn = document.querySelector('.tab-btn[data-target="new"]');
			const firstBtn = document.querySelector('.tab-btn');
			const targetBtn = newBtn || firstBtn;

			if (targetBtn) {
				activateTab(targetBtn.dataset.target, targetBtn);
			}

			// Ensure layout is correct
			if (typeof positionContent === "function") positionContent();
		});
	});

  })
  .catch(err => console.error(err));

</script>

<!-- ============================================================
     JS SECTION 6 — SEARCH SYSTEM (SLIMMED & WORKING)
============================================================ -->
<script>
const searchBox = document.getElementById("search-box");
const resultSec = document.getElementById("search-results");
const excludedTabs = ["about-section", "tip-section", "info-section", "contact-section"];

searchBox.addEventListener("input", () => {
    clearDoubleTapSelection(); // <-- NEW: releasing armed icon on search input
    const q = searchBox.value.toLowerCase();

    // Clear previous search results
    resultSec.innerHTML = "";

    // If search is empty, hide results and restore nothing
    if (!q) {
        resultSec.classList.remove("active");
        return;
    }

    // DEACTIVATE CURRENT TAB AND TAB BUTTONS
    document.querySelectorAll('.tab-content').forEach(sec =>
        sec.classList.remove('active')
    );
    document.querySelectorAll('.tab-btn').forEach(btn =>
        btn.classList.remove('active')
    );

    const grid = document.createElement("ul");
    grid.className = "icon-grid";
    const found = new Set();

    // The excludedTabs array prevents searching these sections
    document.querySelectorAll('.tab-content').forEach(sec => {
        if (excludedTabs.includes(sec.id)) return;  // Skip excluded sections

        sec.querySelectorAll('.icon-wrapper').forEach(icon => {

			// ------------------------------------------------------------
			// 1. ICON VISIBLE TEXT
			//    This is the label shown under each icon
			// ------------------------------------------------------------
			const txt =
				icon.querySelector('.icon-text')?.textContent.toLowerCase() || "";

			// ------------------------------------------------------------
			// 2. TOOLTIP TEXT
			//    Pulled from data-tooltip attribute (if present)
			// ------------------------------------------------------------
			const tip =
				(icon.dataset.tooltip || "").toLowerCase();

			// ------------------------------------------------------------
			// 3. LINK URL (href)
			//    Allows searching by domain or partial URL
			// ------------------------------------------------------------
			const link = icon.closest('a');
			const href =
				link ? (link.getAttribute('href') || "").toLowerCase() : "";

			// ------------------------------------------------------------
			// 4. IMAGE ALT TEXT  ← NEW
			//    Uses <img alt=""> from your list.json
			// ------------------------------------------------------------
			const img = icon.querySelector('img');
			const alt =
				img ? (img.getAttribute('alt') || "").toLowerCase() : "";

			// ------------------------------------------------------------
			// 5. MATCH LOGIC
			//    Matches if query appears in ANY searchable field
			// ------------------------------------------------------------
			if (
				(txt.includes(q) ||
				 tip.includes(q) ||
				 href.includes(q) ||
				 alt.includes(q)) &&

				// Prevent duplicate entries in search results
				!found.has(txt)
			) {
				// Clone the original <li> so layout + links remain intact
				grid.appendChild(icon.closest("li").cloneNode(true));

				// Track this item as already added
				found.add(txt);
			}
		});

    });

    // If any matches are found, display the results
    if (found.size > 0) {
        resultSec.appendChild(grid);
        resultSec.classList.add("active");

        
    }

    else {
        resultSec.classList.remove("active");
    }
});
</script>


<!-- ============================================================
     JS SECTION 7 — COPY BUTTON SOUND
============================================================ -->

<script>
document.addEventListener("click", (e) => {
    if (e.target.id === "copy-tip-btn") {
        document.getElementById("copy-sfx").play();
    }
});
</script>


<script>
/* ============================================================
 JS SECTION 8 — MOBILE / DESKTOP MODE TOGGLE (STATE-PRESERVING + FADE)
 - Switches CSS only
 - Preserves active tab + content
 - Waits for CSS + fonts before measuring
============================================================ */

// DOM references from your original code
const mobileToggle = document.getElementById("mobile-toggle");
const mobileCSS    = document.getElementById("mobile-css");
const wrapper      = document.getElementById("page-wrapper");

// ---------------------
// [NEW] readiness utils
// ---------------------
function waitForCss(linkEl) {
  return new Promise((resolve, reject) => {
    if (linkEl.sheet) return resolve();   // already loaded (cache)
    linkEl.addEventListener('load', resolve, { once: true });
    linkEl.addEventListener('error', () => reject(new Error('Failed to load CSS')), { once: true });
  });
}

function waitForFonts() {
  if (document.fonts && document.fonts.ready) {
    return document.fonts.ready.catch(() => {});
  }
  return Promise.resolve();
}

// ---------------------
// State capture/restore
// ---------------------
function captureUIState() {
  return {
    activeTabBtn: document.querySelector(".tab-btn.active"),
    activeHeaderLink: document.querySelector(".header-text-link.active"),
    activeSection: document.querySelector(".tab-content.active")
  };
}


function restoreUIState(state) {
  const hasSomething =
    state.activeTabBtn || state.activeHeaderLink || state.activeSection;

  // Only clear if we actually have a saved state to restore
  if (hasSomething) {
    document.querySelectorAll(".tab-btn, .header-text-link")
      .forEach(el => el.classList.remove("active"));
    document.querySelectorAll(".tab-content")
      .forEach(sec => sec.classList.remove("active"));

    if (state.activeTabBtn) state.activeTabBtn.classList.add("active");
    if (state.activeHeaderLink) state.activeHeaderLink.classList.add("active");
    if (state.activeSection) state.activeSection.classList.add("active");
  }
}


// ---------------------
// [REPLACED] Enablers
// ---------------------
function enableMobileMode(state) {
  mobileCSS.href = "styles/mobile.css";        // begin loading mobile CSS
  mobileToggle.textContent = "desktop";
  localStorage.setItem("ui-mode", "mobile");

  // Flush layout queue
  void document.body.offsetHeight;

  // Wait for stylesheet + fonts (prevents first-paint mis-measure)
  Promise.all([waitForCss(mobileCSS), waitForFonts()]).then(() => {
    // Double rAF to ensure final style/layout commit
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        restoreUIState(state);
        if (typeof positionContent === "function") positionContent();
      });
    });
  });
}

function disableMobileMode(state) {
  mobileCSS.href = "";                         // remove mobile CSS
  mobileToggle.textContent = "mobile";
  localStorage.setItem("ui-mode", "desktop");

  void document.body.offsetHeight;

  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      restoreUIState(state);
      if (typeof positionContent === "function") positionContent();
    });
  });
}

// ---------------------
// Fade transition (keep)
// ---------------------
function swapModeWithFade(enableMobile) {
  wrapper.classList.add("fading");        // fade out
  setTimeout(() => {
    const state = captureUIState();
    if (enableMobile) enableMobileMode(state);
    else              disableMobileMode(state);
    // ==================== NEW ====================
    // Reveal page after mode is applied
    wrapper.style.visibility = "visible"; // NEW
    // ==================== END NEW ====================
  }, 50);
  setTimeout(() => {
    wrapper.classList.remove("fading");   // fade back in
  }, 200);
}

// Toggle handler (keep)
mobileToggle.addEventListener("click", (e) => {
  e.preventDefault();
  e.stopPropagation();                // prevent tab logic
  clearDoubleTapSelection();      // <-- NEW: release armed icon on mode toggle
  mobileToggle.classList.add("blink");
  setTimeout(() => mobileToggle.classList.remove("blink"), 150);
  mobileToggle.classList.remove("active");
  const enableMobile = localStorage.getItem("ui-mode") !== "mobile";
  swapModeWithFade(enableMobile);
});

// Restore mode on page load (keep)
window.addEventListener("load", () => {
  if (localStorage.getItem("ui-mode") === "mobile") {
    const state = captureUIState();
    enableMobileMode(state);
  }
});

// [OPTIONAL] One-time re-measure after fonts become ready
window.addEventListener("load", () => {
  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(() => {
      if (typeof positionContent === "function") positionContent();
    });
  }
});

// [OPTIONAL] Re-measure after BFCache restore (history navigation)
window.addEventListener("pageshow", () => {
  if (typeof positionContent === "function") positionContent();
});
    
// Auto-enable mobile mode on smartphones
(function() {
    const isMobileDevice = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

    // Only enable if no previous choice was stored
    if (isMobileDevice && localStorage.getItem("ui-mode") !== "mobile") {
        const state = captureUIState?.() || {};
        enableMobileMode(state);
    }
})();
    
</script>


<!-- ============================================================
     JS SECTION 9 — DEFERRED FIREFLY BACKGROUND LOADER
     ------------------------------------------------------------
     - Runs AFTER page is fully loaded
     - Uses idle time when possible
     - Zero impact on interactivity
============================================================ -->
<script>
(function () {
    const PARTICLE_COUNT = 33;

    function createFireflies() {
        const fireflyLayer = document.getElementById("firefly-layer");
        if (!fireflyLayer) return;

        for (let i = 0; i < PARTICLE_COUNT; i++) {
            const f = document.createElement("div");
            f.className = "firefly";

            f.style.setProperty("--x", Math.random() * 100);
            f.style.setProperty("--duration", 8 + Math.random() * 10 + "s");
            f.style.setProperty("--fade-duration", 2 + Math.random() * 3 + "s");
            f.style.setProperty("--delay", Math.random() * 10 + "s");
            f.style.setProperty("--firefly-size", 3 + Math.random() * 4 + "px");

            fireflyLayer.appendChild(f);
        }
    }

    function deferFireflies() {
        if ("requestIdleCallback" in window) {
            requestIdleCallback(createFireflies, { timeout: 1500 });
        } else {
            setTimeout(createFireflies, 800);
        }
    }

    window.addEventListener("load", deferFireflies);
})();
</script>

</div>
</body>
</html>
